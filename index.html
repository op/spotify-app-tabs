<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<style>
			@import url('$views/css/buttons.css');
			@import url('$views/css/image.css');
			@import url('$views/css/list.css');
			@import url('sp://tabify/css/main.css');
		</style>
	</head>
	<body>
		<div id="wrapper">
			<div id="index" class="section">
				<h1>Tabify</h1>
			</div>

			<select id="test-file">
				<option value="tabs/test-file.gp5">Test file</option>
			</select>
			<input id="load-test-file" type="button" value="Load" />
			|

			<label for="song-tracks">Tracks:</label>
			<select id="song-tracks">
			</select>
			<input id="select-song-track" type="button" value="Show" />
			|

			<select id="zoom">
				<option value="0.5">50%</option>
				<option value="0.75">75%</option>
				<option value="1.0">100%</option>
				<option value="1.1" selected="selected">110%</option>
				<option value="1.25">125%</option>
				<option value="1.5">150%</option>
				<option value="2.0">200%</option>
			</select>

			<br />

			<div id="tablature" />
		</div>

		<script src="sp://tabify/js/jquery.min.js"></script>
		<script src="sp://tabify/js/alphaTab.min.js"></script>
		<script src="sp://tabify/js/jquery.alphaTab.min.js"></script>
		<script>
			$(document).ready(function() {
				var api = $('div#tablature').alphaTab({
					loadCallback: function(song) {
						var selected = false;
						var re = /guitar/i;
						var tracks = $('#song-tracks');
						tracks.find('option').remove();
						for (var i = 0; i < song.tracks.length; i++) {
							var elm = $('<option value="'+i+'">'+song.tracks[i].name+'</option>');
							if (selected == false && song.tracks[i].name.match(re)) {
								api.options.track = i;
								selected = true;
								elm.attr("selected", "selected");
							}
							tracks.append(elm);
						}
					}
				});

				// initialize button events
				$('#load-test-file').click(function(){
					var testFile = $('#test-file :selected').val();
					api.loadFile(testFile);
				});
				$('#zoom').change(function(){
					var zoomlvl = parseFloat($('#zoom :selected').val());
					api.tablature.updateScale(zoomlvl);
				});
				$('#select-song-track').click(function() {
					var index = parseInt($('#song-tracks :selected').val());
					api.tablature.setTrack(api.tablature.track.song.tracks[index]);
				});

				// automatically load the first file
				api.loadFile($('#test-file :selected').val());
			});
		</script>
	</body>
</html>
